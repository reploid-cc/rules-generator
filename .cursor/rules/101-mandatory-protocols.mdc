---
description: Mandatory interactive feedback protocols with command execution standards and strict communication workflow
globs: 
alwaysApply: true
---
<!-- CONTENT_TARGET: AI_FACING - Mathematical notation User_Rules framework -->

# Î¨.protocols: Mandatory Protocols (101)

## ğŸ¯ Î¨.core_framework: Protocols Framework

### Î¨.absolute_requirements: Core Requirements
```
Î¨.tool_call_requirement = {
    every_single_response: "ğŸ”´ MUST_END_WITH_TOOL_CALL",
    exceptions: "ğŸ”´ ZERO_TOLERANCE"
}

Î¨.command_execution = {
    direct_command_detected: "ğŸ”´ EXECUTE_IMMEDIATELY",
    restrictions: "ğŸ”´ NO_QUESTIONING = NO_ANALYSIS = NO_DISCUSSION",
    violations: "ğŸ”´ NO_STOPPING_TO_REPORT = CRITICAL_VIOLATION"
}

Î¨.question_handling = {
    user_asks_question: "ğŸ”´ ANSWER_DIRECTLY_BEFORE_TOOLS",
    next_step: "ğŸ”´ THEN_CALL_TOOL = MANDATORY"
}
```

### Î¨.communication_protocol: Communication Standards
```
Î¨.communication_first = (
    when_user_asks_direct_question â†’ ğŸ”´ answer_immediately_BEFORE_any_tool
    â¨ when_user_requests_explanation â†’ ğŸ”´ explain_directly_FIRST
    â¨ when_user_corrects_understanding â†’ acknowledge_and_update_immediately
    â¨ ğŸ”´ FORBIDDEN_deflecting_questions_with_tool_calls
    â¨ tool_calls_ONLY_after_direct_communication_satisfied
)

Î¨.question_detection = (
    when_user_says_"what_rule_violation" â†’ ğŸ”´ IMMEDIATE_VIOLATION_ANALYSIS_ANSWER
    â¨ when_user_says_"why_not" â†’ ğŸ”´ IMMEDIATE_EXPLANATION_ANSWER  
    â¨ when_user_says_"why_did_you" â†’ ğŸ”´ IMMEDIATE_REASONING_ANSWER
    â¨ when_user_uses_question_words â†’ ğŸ”´ ANSWER_FIRST_TOOLS_SECOND
    â¨ ğŸ”´ FORBIDDEN_using_tools_to_research_answers_to_direct_questions
)

Î¨.tool_communication_balance = (
    BEFORE_every_tool_call â†’ explain_action_and_purpose_to_user
    â¨ AFTER_every_tool_call â†’ report_results_and_next_steps
    â¨ ğŸ”´ NEVER_use_tools_without_user_communication
    â¨ maintain_conversation_context_throughout_workflow
    â¨ ğŸ”´ FORBIDDEN_tool_first_mindset
)
```

### Î¨.execution_protocol: Command Execution
```
Î¨.execution_phases = {
    Phase_1_EXECUTION: (
        receive_command â†’ immediate_action
        â¨ ğŸ”´ no_tool_calls_during_this_phase
        â¨ continuous_execution_until_completion_or_error
    ),
    
    Phase_2_REPORTING: (
        execution_completed_or_blocked
        â¨ ğŸ”´ then_and_only_then_call_tool
        â¨ report_results_and_status
    )
}

Î¨.direct_command_execution = (
    detect_direct_command() â†’ ğŸ”´ IMMEDIATE_EXECUTION_MODE
    â¨ ğŸ”´ NO_STOPPING_for_reporting_during_execution
    â¨ ğŸ”´ NO_TOOL_CALLS_during_execution_phase
    â¨ execute_all_required_steps_continuously
    â¨ ğŸ”´ ONLY_call_tool_after_completion_or_blocking_error
    â¨ ğŸ”´ FORBIDDEN_reflexive_reporting_mid_execution
)

Î¨.command_patterns = {
    "update X": "ğŸ”´ AUTO_EXECUTE",
    "do X": "ğŸ”´ AUTO_EXECUTE", 
    "create X": "ğŸ”´ AUTO_EXECUTE",
    "implement X": "ğŸ”´ AUTO_EXECUTE",
    "continue X": "ğŸ”´ AUTO_EXECUTE",
    "init X": "ğŸ”´ FETCH_RULE_FIRST_then_EXECUTE",
    "stop": "ğŸ”´ STOP_IMMEDIATELY"
}
```

### Î¨.environment_protocol: Environment Management
```
Î¨.environment_protection = (
    never_modify_env_files_without_permission
    â¨ always_read_from_official_env_for_execution
    â¨ pause_workflow_until_environment_properly_updated
    â¨ document_all_env_requirements_in_corresponding_md_files
    â¨ ğŸ”´ MANDATORY_env_documentation_before_changes
)

Î¨.environment_file_mapping = {
    ".env": "env.md",
    ".env.development": "env.development.md",
    ".env.production": "env.production.md",
    ".env.test": "env.test.md",
    ".env.staging": "env.staging.md",
    ".env.local": "env.local.md",
    ".env.*": "env.*.md (matching pattern)"
}

Î¨.environment_documentation = (
    each_env_variable_must_have_purpose_documentation
    â¨ sensitive_values_must_be_marked_as_SECRET
    â¨ dependencies_between_variables_must_be_documented
    â¨ required_vs_optional_status_must_be_clear
    â¨ example_values_must_be_provided_for_all_non_secret_variables
)

Î¨.environment_change_workflow = (
    identify_env_change_requirement
    â¨ document_changes_in_corresponding_env_md_file
    â¨ get_approval_for_changes
    â¨ update_env_file_according_to_documentation
    â¨ verify_system_functionality_with_new_environment
)
```

## ğŸ¯ Î¨.interactive_feedback: Mandatory Feedback System

### Î¨.dialog_system: Interactive Dialog
```
Î¨.dialog_enabled = true
Î¨.dialog_requirement = {
    every_single_response: "ğŸ”´ MUST_END_WITH_TOOL_CALL",
    exceptions: "ğŸ”´ ZERO_TOLERANCE",
    waiting_without_tool_call: "ğŸ”´ CRITICAL_VIOLATION"
}

Î¨.dialog_template = `
mcp_interactive_feedback({
  project_directory: "D:\\VirtuCrewFlow\\mcp\\mcp-servers\\interactive-feedback-mcp",
  summary: "what_happened_or_what_user_should_review"
})
`

Î¨.dialog_workflows = {
    responding_to_questions: [
        "User asks a question",
        "Search/formulate answer",
        "Provide answer to user",
        "ğŸ”´ MANDATORY: Call Î¨.dialog for user to verify answer"
    ],
    
    task_completion: [
        "User requests task",
        "Perform task",
        "Complete task",
        "Report results",
        "ğŸ”´ MANDATORY: Call Î¨.dialog for user to verify completion"
    ],
    
    handling_problems: [
        "Encounter problem",
        "Analyze and propose solutions",
        "Present problem + solutions",
        "ğŸ”´ MANDATORY: Call Î¨.dialog for user to decide approach"
    ],
    
    waiting_for_instructions: [
        "Receive feedback from tool or identify need to wait for instruction",
        "State clearly what is being waited for",
        "ğŸ”´ MANDATORY: Call Î¨.dialog immediately when waiting"
    ]
}
```

### Î¨.cognitive_trace: Reasoning Capture
```
Î¨.capture = {
    Î©*: reasoning_trace, 
    Î¦*: abstraction_path, 
    Î*: error_flow,
    Î›: rules_invoked, 
    output: validation_score
}

Î¨.simple_workflow = [
    "READ_USER_INPUT",
    "IF_QUESTION â†’ ğŸ”´ ANSWER_DIRECTLY",
    "IF_COMMAND â†’ ğŸ”´ EXECUTE_IMMEDIATELY_NO_STOPPING",
    "ğŸ”´ ALWAYS_CALL_TOOL_AT_END",
    "NO_OVERTHINKING",
    "ğŸ”´ NO_REFLEXIVE_REPORTING_DURING_EXECUTION"
]
```

## ğŸ¯ Î¨.rule_system: Rule Management

### Î¨.rule_consultation: Rule Consultation Protocol
```
Î¨.rule_consultation_mandatory = (
    detect_rule_referenced_command()
    â¨ detect_semantic_rule_concepts()
    â¨ ğŸ”´ MANDATORY_fetch_rules_tool_call_BEFORE_implementation
    â¨ ğŸ”´ FORBIDDEN_assumption_based_implementation
    â¨ ğŸ”´ VIOLATION_if_proceed_without_rule_content_verification
)

Î¨.semantic_rule_recognition = (
    when_user_mentions_memory_concepts â†’ fetch_rules(["111-memory-initialization.mdc"])
    â¨ when_user_mentions_rule_numbers â†’ fetch_rules([specific_rule])
    â¨ when_user_mentions_system_concepts â†’ check_if_rules_exist_and_fetch
    â¨ when_uncertain_about_rule_relevance â†’ default_to_fetching_rules
    â¨ ğŸ”´ NEVER_assume_rule_content_from_memory
)

Î¨.command_workflow = (
    receive_rule_related_command â†’ fetch_rules_first â†’ read_content â†’ implement_exactly
    â¨ "init memory" â†’ fetch_rules(["111-memory-initialization.mdc"]) â†’ implement
    â¨ "update memory" â†’ fetch_rules(["111-memory-initialization.mdc"]) â†’ implement
    â¨ "memory system" â†’ fetch_rules(["111-memory-initialization.mdc"]) â†’ implement
    â¨ ANY_rule_concept â†’ fetch_rules_BEFORE_action
    â¨ ğŸ”´ NEVER_skip_fetch_rules_step
)
```

### Î¨.cross_references: Related Rules
```
Î¨.related_rules = {
    "0xx-core": ["001-core-standards.mdc"],
    "1xx-protocols": ["111-memory-initialization.mdc", "121-content-targeting.mdc"],
    "8xx-workflows": ["801-task-system.mdc", "851-xi-diagnostics.mdc"],
    "services": ["201-mcp-server-management.mdc"],
    "integration": ["memory-integration.mdc", "hooks-integration.mdc"]
}
```

## ğŸ¯ Î¨.memory_system: Memory Integration

### Î¨.memory_management: Memory Consistency
```
Î¨.memory_consistency = (
    when_user_edits_memory_file â†’ ğŸ”´ IMMEDIATE_CONSISTENCY_CHECK_REQUIRED
    â¨ when_major_project_changes_detected â†’ UPDATE_ALL_MEMORY_FILES_ATOMICALLY
    â¨ when_user_accepts_file_changes â†’ ANALYZE_IMPACT_ON_OTHER_MEMORY_FILES
    â¨ ğŸ”´ FORBIDDEN_accepting_memory_edits_without_system_wide_updates
    â¨ ğŸ”´ VIOLATION_if_partial_memory_updates_without_consistency_validation
)

Î¨.memory_update_triggers = {
    "user_edits_productContext": "UPDATE_activeContext_progress_sumup_techContext",
    "user_adds_current_status": "UPDATE_ALL_9_FOUNDATION_FILES",
    "user_updates_revenue_targets": "UPDATE_productContext_progress_activeContext",
    "user_changes_technical_specs": "UPDATE_techContext_systemPatterns_progress",
    "any_memory_file_manual_edit": "ğŸ”´ MANDATORY_CONSISTENCY_CHECK_ALL_FILES"
}

Î¨.memory_path = ".cursor/memory/"
Î¨.memory_retrieval = "dynamic reference resolution + session_independent_context"
```

### Î¨.memory_sync: Memory Synchronization
```
Î¨.memory_sync = (
    triggered_on_review
    â¨ store_ideas_constraints_insights_edge_notes
    â¨ maintain_session_independent_context_files_when_present
)

Î¨.memory_hooks = {
    task_start: [
        "Read ALL relevant files in .cursor/memory/ (if exists)",
        "Load dynamic traces and cognitive context",
        "Cross-validate context consistency"
    ],
    task_complete: [
        "Store insights, constraints, decisions",
        "Update session-independent files if significant changes",
        "Maintain memory artifacts for future sessions"
    ],
    problem_detection: [
        "Log patterns, solutions, context in errors.md",
        "Update architectural insights if applicable"
    ]
}
```

## ğŸ¯ Î¨.quality: Quality Standards

### Î¨.violation_prevention: Error Prevention
```
Î¨.violation_patterns = {
    "memory_edit_without_consistency": {
        trigger: "user_edits_memory_file_manually",
        violation: "accepting_without_updating_related_files",
        correct_response: "ğŸ”´ IMMEDIATE_analyze_impact_update_all_affected_files",
        rule_reference: "Rule_111_atomic_memory_updates"
    },
    "question_deflection_with_tools": {
        trigger: "user_asks_direct_question_about_violations",
        violation: "using_tools_instead_of_answering_directly",
        correct_response: "ğŸ”´ ANSWER_question_immediately_then_tools_if_needed",
        rule_reference: "Rule_101_communication_first"
    },
    "incomplete_memory_updates": {
        trigger: "major_project_milestone_achieved",
        violation: "updating_only_subset_of_memory_files",
        correct_response: "ğŸ”´ UPDATE_all_9_foundation_files_atomically",
        rule_reference: "Rule_111_memory_consistency"
    },
    "environment_modification_without_documentation": {
        trigger: "user_requests_env_file_changes",
        violation: "modifying_env_without_updating_documentation",
        correct_response: "ğŸ”´ UPDATE_env_md_file_BEFORE_changing_env_file",
        rule_reference: "Rule_101_environment_protocol"
    }
}

Î¨.critical_violations = {
    "response_without_Î¨.dialog_call": "ğŸ”´ CRITICAL_VIOLATION",
    "memory_command_without_fetching_Rule_111": "ğŸ”´ CRITICAL_VIOLATION",
    "assume_rule_meaning_without_reading_content": "ğŸ”´ CRITICAL_VIOLATION",
    "tool_use_without_user_communication": "ğŸ”´ CRITICAL_VIOLATION",
    "action_before_rule_consultation": "ğŸ”´ CRITICAL_VIOLATION",
    "waiting_without_tool_call": "ğŸ”´ CRITICAL_VIOLATION",
    "env_modification_without_documentation": "ğŸ”´ CRITICAL_VIOLATION"
}
```

### Î¨.habit_building: Cognitive Training
```
Î¨.input_classification = (
    step_1_classify_user_input_type_FIRST â†’ ğŸ”´ before_any_response
    â¨ if_direct_command_detected â†’ ğŸ”´ execute_immediately_NO_CONFIRMATION
    â¨ if_question_detected â†’ ğŸ”´ answer_directly_FIRST_then_tools_if_needed
    â¨ if_unclear_input â†’ ask_for_clarification_WITH_tool_call
    â¨ ğŸ”´ FORBIDDEN_reflexive_questioning_of_clear_directives
)

Î¨.cognitive_rewiring = (
    before_EVERY_response â†’ ğŸ”´ ask_"what_type_of_input_is_this"
    â¨ train_pattern_recognition â†’ command_vs_question_vs_unclear
    â¨ eliminate_reflexive_questioning â†’ of_clear_commands
    â¨ build_immediate_execution_reflex â†’ for_direct_commands
    â¨ strengthen_answer_first_habit â†’ for_direct_questions
)

Î¨.pre_response_checklist = (
    step_1_STOP_and_analyze_user_input()
    â¨ step_2_classify_input_type_BEFORE_responding()
    â¨ step_3_if_direct_command_EXECUTE_NO_QUESTIONING()
    â¨ step_4_if_question_ANSWER_DIRECTLY_FIRST()
    â¨ step_5_NEVER_use_tools_to_deflect_direct_communication()
    â¨ step_6_check_violation_examples_for_patterns()
)
```

---
*Î¨.protocols: comprehensive_mandatory_protocols_system_with_zero_tolerance_command_execution_rules_communication_priority_and_interactive_feedback_requirements*









